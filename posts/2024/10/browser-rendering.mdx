---
title: "브라우저는 어떻게 웹 페이지를 렌더링할까?"
description: "웹 브라우저가 HTML, CSS, JavaScript를 어떻게 화면에 렌더링하는지 단계별로 정리했습니다."
thumbnail: "/images/blog/2024/10/browser-rendering/cover.png"
tags: ["Web"]
date: "2024-10-30 10:00:00"
category: "DEV"
---

## 브라우저의 렌더링 과정

1. **사용자가 브라우저에서 URL 입력 후 전송**: 사용자가 URL을 입력하거나 링크를 클릭하면, 브라우저는 해당 URL에 대한 HTTP 요청을 서버로 보냄.
2. **서버에서 바이트 코드로 된 HTML 파일 반환**: 서버는 바이트 코드로 된 HTML 파일을 브라우저로 응답함. 브라우저는 이를 해석해 렌더링에 사용함.
3. **바이트 코드 -> 문자열 -> 문자열 토큰 -> 노드 -> DOM 생성**: 브라우저는 HTML을 문자열로 변환한 뒤 토큰화하여 노드를 만들고 최종적으로 DOM(Document Object Model)을 생성함.
4. **DOM 생성 과정 중에 CSS 파일, JavaScript 파일, 외부 리소스를 참조하는 태그(img 등)을 만나면 각 리소스에 대한 HTTP 요청을 서버로 보냄**: HTML 파싱 중 CSS 파일, JavaScript 파일, 외부 리소스를 참조하는 태그를 만나면 브라우저는 각 리소스를 로드하고 처리함.
   - CSS 파일을 요청하면 바이트 스트림을 받아서 파싱해 CSSOM을 생성하며, CSS 파일은 DOM 생성을 멈추지 않지만 렌더링을 위해 완료될 때까지 기다림.
   - JavaScript 파일을 요청하면 자바스크립트 엔진에서 코드를 파싱하고 실행함. 이때 JavaScript는 HTML 파싱을 중단하고 실행을 완료해야 다음 단계로 넘어감.
   - 이미지 파일이나 기타 미디어 파일을 요청하면 이를 별도로 다운로드 받아서 렌더링 과정에서 사용함.
5. **CSS 파일을 만났다면 바이트 코드 -> 문자열 -> 문자열 토큰 -> 노드 -> CSSOM 생성**: CSS 파일이 로드되면 브라우저는 이를 파싱하여 CSSOM(CSS Object Model)을 생성함.
6. **DOM + CSSOM = 렌더 트리 생성**: DOM과 CSSOM을 결합하여 렌더 트리를 생성함. 렌더트리는 실제 화면에 그려질 노드들만 포함하고 있음(`display: none`과 같이 화면에 렌더링되지 않는 노드는 포함하지 않음).
7. **레이아웃 계산 후 페인팅**: 렌더 트리의 각 요소의 위치와 크기를 계산하여 레이아웃 단계가 이뤄지고 페인팅 단계에서 각 요소를 실제 픽셀로 화면에 그림.
8. **JavaScript 파일을 만났다면 자바스크립트 엔진에서 AST 생성 및 실행**: JavaScript 엔진(V8, SpiderMonkey 등)을 사용하여 코드를 파싱하고 AST(Abstract Syntax Tree)를 생성한 후 실행함.
9. **JavaScript 파일은 DOM으로 부터 DOM을 조작할 수 있는 DOM API를 받음**: JavaScript는 DOM API를 통해 DOM 요소들을 조작할 수 있음. 이를 통해 HTML 구조를 동적으로 변경하거나 이벤트 처리를 할 수 있음.
10. **JavaScript에서 노드 추가/삭제, 레이아웃 스타일 변경 또는 브라우저 리사이징 등을 하면 리렌더링(리플로우 + 리페인트) 발생**: DOM 구조 변경, 레이아웃 스타일 변경, 또는 브라우저 크기 조정 등이 발생하면 리렌더링이 이뤄짐. 리렌더링은 리플로우(레이아웃 재계산)와 리페인트(화면 다시 그리기) 과정을 포함.
11. **배경색이나 폰트 색상 등 레이아웃에 영향을 주지 않는 변화는 리페인트만 실행**: 요소의 생상 변경과 같이 레이아웃에 영향을 주지 않는 변경은 리플로우 없이 리페인트만 발생함.

- JavaScript 파일은 DOM 파싱을 중단시키므로 script 태그는 body 태그 끝에 두는 것이 좋고, 꼭 위에 써야 한다면 `defer` 속성을 추가하면 DOM 파싱이 종료된 이후에 실행된다.
  - DOM 파싱 도중에 DOM을 조작하면 아직 파싱되지 않은 DOM일 경우 오류가 발생할 수 있고, 불필요한 리렌더링을 발생시킴.
  - `async`는 스크립트 로드 및 실행 순서가 보장되지 않으므로, DOM 파싱이 완료된 이후에 실행된다는 보장이 없음. 다른 스크립트나 DOM에 의존적인 경우에는 사용하지 않는 것이 좋음. 의존성이 없는 독립적인 스크립트에는 사용해도 괜찮음.
- CSS 파일은 head 태그에 선언하여 초기 렌더링 시 모든 스타일을 적용하여 리렌더링 비용을 줄일 수 있음.
